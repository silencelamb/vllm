HloModule SyncTensorsGraph.147, entry_computation_layout={(bf16[128]{0}, f32[], bf16[4096,1024]{1,0}, bf16[1024]{0}, s32[32]{0}, /*index=5*/bf16[151936,1024]{1,0}, s32[32]{0}, bf16[40960,128]{1,0}, bf16[2,4233,16,8,128]{4,3,2,1,0})->(bf16[32,8,128]{2,1,0}, bf16[32,8,128]{2,1,0}, bf16[4233,16,8,128]{3,2,1,0}, bf16[4233,16,8,128]{3,2,1,0})}

%AddComputation.22 (x.23: f32[], y.24: f32[]) -> f32[] {
  %x.23 = f32[] parameter(0)
  %y.24 = f32[] parameter(1)
  ROOT %add.25 = f32[] add(f32[] %x.23, f32[] %y.24)
}

%AddComputation.60 (x.61: f32[], y.62: f32[]) -> f32[] {
  %x.61 = f32[] parameter(0)
  %y.62 = f32[] parameter(1)
  ROOT %add.63 = f32[] add(f32[] %x.61, f32[] %y.62)
}

ENTRY %SyncTensorsGraph.147 (p0.1: bf16[128], p1.4: f32[], p2.6: bf16[4096,1024], p3.8: bf16[1024], p4.12: s32[32], p5.14: bf16[151936,1024], p6.92: s32[32], p7.93: bf16[40960,128], p8.137: bf16[2,4233,16,8,128]) -> (bf16[32,8,128], bf16[32,8,128], bf16[4233,16,8,128], bf16[4233,16,8,128]) {
  %p5.14 = bf16[151936,1024]{1,0} parameter(5), metadata={op_type="xla__device_data" op_name="xla__device_data" source_file="/usr/local/lib/python3.10/site-packages/torch_xla/_dynamo/dynamo_bridge.py" source_line=355}
  %p4.12 = s32[32]{0} parameter(4), metadata={op_type="xla__device_data" op_name="xla__device_data" source_file="/usr/local/lib/python3.10/site-packages/torch_xla/_dynamo/dynamo_bridge.py" source_line=355}
  %convert.13 = s64[32]{0} convert(s32[32]{0} %p4.12), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.15 = u32[32]{0} convert(s64[32]{0} %convert.13), metadata={op_type="aten__index_select" op_name="aten__index_select" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %gather.16 = bf16[32,1024]{1,0} gather(bf16[151936,1024]{1,0} %p5.14, u32[32]{0} %convert.15), offset_dims={1}, collapsed_slice_dims={0}, start_index_map={0}, index_vector_dim=1, slice_sizes={1,1024}, metadata={op_type="aten__index_select" op_name="aten__index_select" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.17 = f32[32,1024]{1,0} convert(bf16[32,1024]{1,0} %gather.16), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.11 = f32[] constant(2), metadata={op_type="prim__Constant" op_name="prim__Constant" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.18 = f32[32,1024]{1,0} broadcast(f32[] %constant.11), dimensions={}, metadata={op_type="aten__pow" op_name="aten__pow" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %power.19 = f32[32,1024]{1,0} power(f32[32,1024]{1,0} %convert.17, f32[32,1024]{1,0} %broadcast.18), metadata={op_type="aten__pow" op_name="aten__pow" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.20 = f32[] constant(0), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reduce.26 = f32[32]{0} reduce(f32[32,1024]{1,0} %power.19, f32[] %constant.20), dimensions={1}, to_apply=%AddComputation.22, metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.21 = s32[] constant(1024), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.27 = s32[] constant(0), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %compare.32 = pred[] compare(s32[] %constant.21, s32[] %constant.27), direction=NE, metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.28 = f32[] constant(1), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.30 = f32[] convert(s32[] %constant.21), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %divide.31 = f32[] divide(f32[] %constant.28, f32[] %convert.30), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.29 = f32[] constant(nan), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %select.33 = f32[] select(pred[] %compare.32, f32[] %divide.31, f32[] %constant.29), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.34 = f32[32]{0} broadcast(f32[] %select.33), dimensions={}, metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.35 = f32[32]{0} multiply(f32[32]{0} %reduce.26, f32[32]{0} %broadcast.34), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.36 = f32[32,1]{1,0} reshape(f32[32]{0} %multiply.35), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.37 = f32[32,1]{1,0} convert(f32[32,1]{1,0} %reshape.36), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %p1.4 = f32[] parameter(1), metadata={op_type="xla__device_data" op_name="xla__device_data" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.10 = f32[] constant(1), metadata={op_type="prim__Constant" op_name="prim__Constant" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.38 = f32[] multiply(f32[] %p1.4, f32[] %constant.10), metadata={op_type="aten__add" op_name="aten__add.508/aten__add" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.39 = f32[32,1]{1,0} broadcast(f32[] %multiply.38), dimensions={}, metadata={op_type="aten__add" op_name="aten__add.508/aten__add" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %add.40 = f32[32,1]{1,0} add(f32[32,1]{1,0} %convert.37, f32[32,1]{1,0} %broadcast.39), metadata={op_type="aten__add" op_name="aten__add.508/aten__add" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %rsqrt.41 = f32[32,1]{1,0} rsqrt(f32[32,1]{1,0} %add.40), metadata={op_type="aten__rsqrt" op_name="aten__rsqrt" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.42 = f32[32]{0} reshape(f32[32,1]{1,0} %rsqrt.41), metadata={op_type="aten__mul" op_name="aten__mul.509/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.43 = f32[32,1024]{1,0} broadcast(f32[32]{0} %reshape.42), dimensions={0}, metadata={op_type="aten__mul" op_name="aten__mul.509/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.44 = f32[32,1024]{1,0} multiply(f32[32,1024]{1,0} %convert.17, f32[32,1024]{1,0} %broadcast.43), metadata={op_type="aten__mul" op_name="aten__mul.509/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.45 = bf16[32,1024]{1,0} convert(f32[32,1024]{1,0} %multiply.44), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.46 = f32[32,1024]{1,0} convert(bf16[32,1024]{1,0} %convert.45), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %p3.8 = bf16[1024]{0} parameter(3), metadata={op_type="xla__device_data" op_name="xla__device_data" source_file="/usr/local/lib/python3.10/site-packages/torch_xla/_dynamo/dynamo_bridge.py" source_line=355}
  %convert.9 = f32[1024]{0} convert(bf16[1024]{0} %p3.8), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.47 = f32[32,1024]{1,0} broadcast(f32[1024]{0} %convert.9), dimensions={1}, metadata={op_type="aten__mul" op_name="aten__mul.510/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.48 = f32[32,1024]{1,0} multiply(f32[32,1024]{1,0} %convert.46, f32[32,1024]{1,0} %broadcast.47), metadata={op_type="aten__mul" op_name="aten__mul.510/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.49 = bf16[32,1024]{1,0} convert(f32[32,1024]{1,0} %multiply.48), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %p2.6 = bf16[4096,1024]{1,0} parameter(2), metadata={op_type="xla__device_data" op_name="xla__device_data" source_file="/usr/local/lib/python3.10/site-packages/torch_xla/_dynamo/dynamo_bridge.py" source_line=355}
  %transpose.7 = bf16[1024,4096]{0,1} transpose(bf16[4096,1024]{1,0} %p2.6), dimensions={1,0}, metadata={op_type="aten__permute" op_name="aten__permute" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %dot.50 = bf16[32,4096]{1,0} dot(bf16[32,1024]{1,0} %convert.49, bf16[1024,4096]{0,1} %transpose.7), lhs_contracting_dims={1}, rhs_contracting_dims={0}, metadata={op_type="aten__mm" op_name="aten__mm" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %slice.51 = bf16[32,2048]{1,0} slice(bf16[32,4096]{1,0} %dot.50), slice={[0:32], [0:2048]}, metadata={op_type="aten__split" op_name="aten__split" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %slice.52 = bf16[32,1024]{1,0} slice(bf16[32,4096]{1,0} %dot.50), slice={[0:32], [2048:3072]}, metadata={op_type="aten__split" op_name="aten__split" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.54 = bf16[32,8,128]{2,1,0} reshape(bf16[32,1024]{1,0} %slice.52), metadata={op_type="aten__view" op_name="aten__view" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.55 = f32[32,8,128]{2,1,0} convert(bf16[32,8,128]{2,1,0} %reshape.54), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.5 = f32[] constant(2), metadata={op_type="prim__Constant" op_name="prim__Constant" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.56 = f32[32,8,128]{2,1,0} broadcast(f32[] %constant.5), dimensions={}, metadata={op_type="aten__pow" op_name="aten__pow" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %power.57 = f32[32,8,128]{2,1,0} power(f32[32,8,128]{2,1,0} %convert.55, f32[32,8,128]{2,1,0} %broadcast.56), metadata={op_type="aten__pow" op_name="aten__pow" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.58 = f32[] constant(0), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reduce.64 = f32[32,8]{1,0} reduce(f32[32,8,128]{2,1,0} %power.57, f32[] %constant.58), dimensions={2}, to_apply=%AddComputation.60, metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.59 = s32[] constant(128), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.65 = s32[] constant(0), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %compare.70 = pred[] compare(s32[] %constant.59, s32[] %constant.65), direction=NE, metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.66 = f32[] constant(1), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.68 = f32[] convert(s32[] %constant.59), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %divide.69 = f32[] divide(f32[] %constant.66, f32[] %convert.68), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.67 = f32[] constant(nan), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %select.71 = f32[] select(pred[] %compare.70, f32[] %divide.69, f32[] %constant.67), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.72 = f32[32,8]{1,0} broadcast(f32[] %select.71), dimensions={}, metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.73 = f32[32,8]{1,0} multiply(f32[32,8]{1,0} %reduce.64, f32[32,8]{1,0} %broadcast.72), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.74 = f32[32,8,1]{2,1,0} reshape(f32[32,8]{1,0} %multiply.73), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.75 = f32[32,8,1]{2,1,0} convert(f32[32,8,1]{2,1,0} %reshape.74), metadata={op_type="aten__mean" op_name="aten__mean" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.3 = f32[] constant(1), metadata={op_type="prim__Constant" op_name="prim__Constant" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.76 = f32[] multiply(f32[] %p1.4, f32[] %constant.3), metadata={op_type="aten__add" op_name="aten__add.511/aten__add" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.77 = f32[32,8,1]{2,1,0} broadcast(f32[] %multiply.76), dimensions={}, metadata={op_type="aten__add" op_name="aten__add.511/aten__add" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %add.78 = f32[32,8,1]{2,1,0} add(f32[32,8,1]{2,1,0} %convert.75, f32[32,8,1]{2,1,0} %broadcast.77), metadata={op_type="aten__add" op_name="aten__add.511/aten__add" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %rsqrt.79 = f32[32,8,1]{2,1,0} rsqrt(f32[32,8,1]{2,1,0} %add.78), metadata={op_type="aten__rsqrt" op_name="aten__rsqrt" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.80 = f32[32,8]{1,0} reshape(f32[32,8,1]{2,1,0} %rsqrt.79), metadata={op_type="aten__mul" op_name="aten__mul.512/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.81 = f32[32,8,128]{2,1,0} broadcast(f32[32,8]{1,0} %reshape.80), dimensions={0,1}, metadata={op_type="aten__mul" op_name="aten__mul.512/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.82 = f32[32,8,128]{2,1,0} multiply(f32[32,8,128]{2,1,0} %convert.55, f32[32,8,128]{2,1,0} %broadcast.81), metadata={op_type="aten__mul" op_name="aten__mul.512/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.83 = bf16[32,8,128]{2,1,0} convert(f32[32,8,128]{2,1,0} %multiply.82), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.84 = f32[32,8,128]{2,1,0} convert(bf16[32,8,128]{2,1,0} %convert.83), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %p0.1 = bf16[128]{0} parameter(0), metadata={op_type="xla__device_data" op_name="xla__device_data" source_file="/usr/local/lib/python3.10/site-packages/torch_xla/_dynamo/dynamo_bridge.py" source_line=355}
  %convert.2 = f32[128]{0} convert(bf16[128]{0} %p0.1), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.85 = f32[32,8,128]{2,1,0} broadcast(f32[128]{0} %convert.2), dimensions={2}, metadata={op_type="aten__mul" op_name="aten__mul.513/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.86 = f32[32,8,128]{2,1,0} multiply(f32[32,8,128]{2,1,0} %convert.84, f32[32,8,128]{2,1,0} %broadcast.85), metadata={op_type="aten__mul" op_name="aten__mul.513/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.87 = bf16[32,8,128]{2,1,0} convert(f32[32,8,128]{2,1,0} %multiply.86), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.88 = bf16[32,1024]{1,0} reshape(bf16[32,8,128]{2,1,0} %convert.87), metadata={op_type="aten__view" op_name="aten__view" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.89 = bf16[32,8,128]{2,1,0} reshape(bf16[32,1024]{1,0} %reshape.88), metadata={op_type="aten__view" op_name="aten__view" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %slice.99 = bf16[32,8,64]{2,1,0} slice(bf16[32,8,128]{2,1,0} %reshape.89), slice={[0:32], [0:8], [0:64]}, metadata={op_type="aten__split" op_name="aten__split" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.124 = f32[32,8,64]{2,1,0} convert(bf16[32,8,64]{2,1,0} %slice.99), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %p7.93 = bf16[40960,128]{1,0} parameter(7), metadata={op_type="xla__device_data" op_name="xla__device_data" source_file="/usr/local/lib/python3.10/site-packages/torch_xla/_dynamo/dynamo_bridge.py" source_line=355}
  %p6.92 = s32[32]{0} parameter(6), metadata={op_type="xla__device_data" op_name="xla__device_data" source_file="/usr/local/lib/python3.10/site-packages/torch_xla/_dynamo/dynamo_bridge.py" source_line=355}
  %gather.94 = bf16[32,128]{1,0} gather(bf16[40960,128]{1,0} %p7.93, s32[32]{0} %p6.92), offset_dims={1}, collapsed_slice_dims={0}, start_index_map={0}, index_vector_dim=1, slice_sizes={1,128}, metadata={op_type="aten__index_select" op_name="aten__index_select" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %slice.95 = bf16[32,64]{1,0} slice(bf16[32,128]{1,0} %gather.94), slice={[0:32], [0:64]}, metadata={op_type="aten__split" op_name="aten__split" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.106 = bf16[32,1,64]{2,1,0} reshape(bf16[32,64]{1,0} %slice.95), metadata={op_type="aten__view" op_name="aten__view" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.123 = f32[32,1,64]{2,1,0} convert(bf16[32,1,64]{2,1,0} %reshape.106), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.125 = f32[32,64]{1,0} reshape(f32[32,1,64]{2,1,0} %convert.123), metadata={op_type="aten__mul" op_name="aten__mul.514/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.126 = f32[32,8,64]{2,1,0} broadcast(f32[32,64]{1,0} %reshape.125), dimensions={0,2}, metadata={op_type="aten__mul" op_name="aten__mul.514/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.127 = f32[32,8,64]{2,1,0} multiply(f32[32,8,64]{2,1,0} %convert.124, f32[32,8,64]{2,1,0} %broadcast.126), metadata={op_type="aten__mul" op_name="aten__mul.514/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.128 = bf16[32,8,64]{2,1,0} convert(f32[32,8,64]{2,1,0} %multiply.127), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %slice.100 = bf16[32,8,64]{2,1,0} slice(bf16[32,8,128]{2,1,0} %reshape.89), slice={[0:32], [0:8], [64:128]}, metadata={op_type="aten__split" op_name="aten__split" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.118 = f32[32,8,64]{2,1,0} convert(bf16[32,8,64]{2,1,0} %slice.100), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %slice.96 = bf16[32,64]{1,0} slice(bf16[32,128]{1,0} %gather.94), slice={[0:32], [64:128]}, metadata={op_type="aten__split" op_name="aten__split" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.97 = bf16[32,1,64]{2,1,0} reshape(bf16[32,64]{1,0} %slice.96), metadata={op_type="aten__view" op_name="aten__view" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.117 = f32[32,1,64]{2,1,0} convert(bf16[32,1,64]{2,1,0} %reshape.97), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.119 = f32[32,64]{1,0} reshape(f32[32,1,64]{2,1,0} %convert.117), metadata={op_type="aten__mul" op_name="aten__mul.515/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.120 = f32[32,8,64]{2,1,0} broadcast(f32[32,64]{1,0} %reshape.119), dimensions={0,2}, metadata={op_type="aten__mul" op_name="aten__mul.515/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.121 = f32[32,8,64]{2,1,0} multiply(f32[32,8,64]{2,1,0} %convert.118, f32[32,8,64]{2,1,0} %broadcast.120), metadata={op_type="aten__mul" op_name="aten__mul.515/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.122 = bf16[32,8,64]{2,1,0} convert(f32[32,8,64]{2,1,0} %multiply.121), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.116 = bf16[] constant(1), metadata={op_type="prim__Constant" op_name="prim__Constant" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.129 = bf16[32,8,64]{2,1,0} broadcast(bf16[] %constant.116), dimensions={}, metadata={op_type="aten__sub" op_name="aten__sub.516/aten__sub" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.130 = bf16[32,8,64]{2,1,0} multiply(bf16[32,8,64]{2,1,0} %convert.122, bf16[32,8,64]{2,1,0} %broadcast.129), metadata={op_type="aten__sub" op_name="aten__sub.516/aten__sub" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %subtract.131 = bf16[32,8,64]{2,1,0} subtract(bf16[32,8,64]{2,1,0} %convert.128, bf16[32,8,64]{2,1,0} %multiply.130), metadata={op_type="aten__sub" op_name="aten__sub.516/aten__sub" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.108 = f32[32,8,64]{2,1,0} convert(bf16[32,8,64]{2,1,0} %slice.100), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.107 = f32[32,1,64]{2,1,0} convert(bf16[32,1,64]{2,1,0} %reshape.106), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.109 = f32[32,64]{1,0} reshape(f32[32,1,64]{2,1,0} %convert.107), metadata={op_type="aten__mul" op_name="aten__mul.517/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.110 = f32[32,8,64]{2,1,0} broadcast(f32[32,64]{1,0} %reshape.109), dimensions={0,2}, metadata={op_type="aten__mul" op_name="aten__mul.517/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.111 = f32[32,8,64]{2,1,0} multiply(f32[32,8,64]{2,1,0} %convert.108, f32[32,8,64]{2,1,0} %broadcast.110), metadata={op_type="aten__mul" op_name="aten__mul.517/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.112 = bf16[32,8,64]{2,1,0} convert(f32[32,8,64]{2,1,0} %multiply.111), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.101 = f32[32,8,64]{2,1,0} convert(bf16[32,8,64]{2,1,0} %slice.99), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.98 = f32[32,1,64]{2,1,0} convert(bf16[32,1,64]{2,1,0} %reshape.97), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.102 = f32[32,64]{1,0} reshape(f32[32,1,64]{2,1,0} %convert.98), metadata={op_type="aten__mul" op_name="aten__mul.518/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.103 = f32[32,8,64]{2,1,0} broadcast(f32[32,64]{1,0} %reshape.102), dimensions={0,2}, metadata={op_type="aten__mul" op_name="aten__mul.518/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.104 = f32[32,8,64]{2,1,0} multiply(f32[32,8,64]{2,1,0} %convert.101, f32[32,8,64]{2,1,0} %broadcast.103), metadata={op_type="aten__mul" op_name="aten__mul.518/aten__mul" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %convert.105 = bf16[32,8,64]{2,1,0} convert(f32[32,8,64]{2,1,0} %multiply.104), metadata={op_type="xla__cast" op_name="xla__cast" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %constant.91 = bf16[] constant(1), metadata={op_type="prim__Constant" op_name="prim__Constant" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %broadcast.113 = bf16[32,8,64]{2,1,0} broadcast(bf16[] %constant.91), dimensions={}, metadata={op_type="aten__add" op_name="aten__add.519/aten__add" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %multiply.114 = bf16[32,8,64]{2,1,0} multiply(bf16[32,8,64]{2,1,0} %convert.105, bf16[32,8,64]{2,1,0} %broadcast.113), metadata={op_type="aten__add" op_name="aten__add.519/aten__add" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %add.115 = bf16[32,8,64]{2,1,0} add(bf16[32,8,64]{2,1,0} %convert.112, bf16[32,8,64]{2,1,0} %multiply.114), metadata={op_type="aten__add" op_name="aten__add.519/aten__add" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %concatenate.132 = bf16[32,8,128]{2,1,0} concatenate(bf16[32,8,64]{2,1,0} %subtract.131, bf16[32,8,64]{2,1,0} %add.115), dimensions={2}, metadata={op_type="aten__cat" op_name="aten__cat" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %slice.90 = bf16[32,8,0]{2,1,0} slice(bf16[32,8,128]{2,1,0} %reshape.89), slice={[0:32], [0:8], [128:128]}, metadata={op_type="xla__select" op_name="xla__select" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %concatenate.133 = bf16[32,8,128]{2,1,0} concatenate(bf16[32,8,128]{2,1,0} %concatenate.132, bf16[32,8,0]{2,1,0} %slice.90), dimensions={2}, metadata={op_type="aten__cat" op_name="aten__cat" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.134 = bf16[32,1024]{1,0} reshape(bf16[32,8,128]{2,1,0} %concatenate.133), metadata={op_type="aten__view" op_name="aten__view" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.135 = bf16[32,8,128]{2,1,0} reshape(bf16[32,1024]{1,0} %reshape.134), metadata={op_type="aten__view" op_name="aten__view" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %slice.53 = bf16[32,1024]{1,0} slice(bf16[32,4096]{1,0} %dot.50), slice={[0:32], [3072:4096]}, metadata={op_type="aten__split" op_name="aten__split" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %reshape.136 = bf16[32,8,128]{2,1,0} reshape(bf16[32,1024]{1,0} %slice.53), metadata={op_type="aten__view" op_name="aten__view" source_file="/usr/local/lib/python3.10/site-packages/torch/_ops.py" source_line=756}
  %p8.137 = bf16[2,4233,16,8,128]{4,3,2,1,0} parameter(8), metadata={op_type="xla__device_data" op_name="xla__device_data" source_file="/usr/local/lib/python3.10/site-packages/torch_xla/_dynamo/dynamo_bridge.py" source_line=355}
  %reshape.138 = bf16[138706944]{0} reshape(bf16[2,4233,16,8,128]{4,3,2,1,0} %p8.137), metadata={op_type="aten__as_strided" op_name="aten__as_strided" source_file="/usr/local/lib/python3.10/site-packages/torch/_prims_common/__init__.py" source_line=1991}
  %reshape.139 = bf16[2,4233,16,8,128]{4,3,2,1,0} reshape(bf16[138706944]{0} %reshape.138), metadata={op_type="aten__as_strided" op_name="aten__as_strided" source_file="/usr/local/lib/python3.10/site-packages/torch/_prims_common/__init__.py" source_line=1992}
  %reshape.140 = bf16[138706944]{0} reshape(bf16[2,4233,16,8,128]{4,3,2,1,0} %reshape.139), metadata={op_type="aten__as_strided" op_name="aten__as_strided" source_file="/usr/local/lib/python3.10/site-packages/torch/_higher_order_ops/auto_functionalize.py" source_line=54}
  %slice.141 = bf16[69353472]{0} slice(bf16[138706944]{0} %reshape.140), slice={[0:69353472]}, metadata={op_type="aten__as_strided" op_name="aten__as_strided" source_file="/usr/local/lib/python3.10/site-packages/torch/_higher_order_ops/auto_functionalize.py" source_line=54}
  %reshape.142 = bf16[4233,16,8,128]{3,2,1,0} reshape(bf16[69353472]{0} %slice.141), metadata={op_type="aten__as_strided" op_name="aten__as_strided" source_file="/usr/local/lib/python3.10/site-packages/torch/_higher_order_ops/auto_functionalize.py" source_line=54}
  %reshape.143 = bf16[138706944]{0} reshape(bf16[2,4233,16,8,128]{4,3,2,1,0} %reshape.139), metadata={op_type="aten__as_strided" op_name="aten__as_strided" source_file="/usr/local/lib/python3.10/site-packages/torch/_higher_order_ops/auto_functionalize.py" source_line=54}
  %slice.144 = bf16[69353472]{0} slice(bf16[138706944]{0} %reshape.143), slice={[69353472:138706944]}, metadata={op_type="aten__as_strided" op_name="aten__as_strided" source_file="/usr/local/lib/python3.10/site-packages/torch/_higher_order_ops/auto_functionalize.py" source_line=54}
  %reshape.145 = bf16[4233,16,8,128]{3,2,1,0} reshape(bf16[69353472]{0} %slice.144), metadata={op_type="aten__as_strided" op_name="aten__as_strided" source_file="/usr/local/lib/python3.10/site-packages/torch/_higher_order_ops/auto_functionalize.py" source_line=54}
  ROOT %tuple.146 = (bf16[32,8,128]{2,1,0}, bf16[32,8,128]{2,1,0}, bf16[4233,16,8,128]{3,2,1,0}, bf16[4233,16,8,128]{3,2,1,0}) tuple(bf16[32,8,128]{2,1,0} %reshape.135, bf16[32,8,128]{2,1,0} %reshape.136, bf16[4233,16,8,128]{3,2,1,0} %reshape.142, bf16[4233,16,8,128]{3,2,1,0} %reshape.145)
}

